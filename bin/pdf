#!/usr/bin/env zsh

. ~/.config/zsh/alias.zsh

paths="/mnt/c/notes/
/mnt/c/Users/$win_username/Downloads/"

s="/mnt/c/$(echo $paths | xargs fd -e pdf . | sed 's|/mnt/c/||' | dmenu)"

wpath=`wslpath -w "$s"`

pdfviewers="firefox
SumatraPDF
default
okular
pdfgear
SumatraPDF-new-window
firefox-new
speedread"

opener=$(echo $pdfviewers | dmenu)
if [ "$opener" = "firefox" ]; then
  firefox "$wpath"
elif [ "$opener" = "firefox-new" ]; then
  firefox -new-window "$wpath" 
elif [ "$opener" = "okular" ]; then
  "/mnt/c/Program Files/Okular/bin/okular.exe" "$wpath"
elif [ "$opener" = "SumatraPDF" ]; then
  /mnt/c/Users/$win_username/AppData/Local/SumatraPDF/SumatraPDF.exe "$wpath"
elif [ "$opener" = "SumatraPDF-new-window" ]; then
  /mnt/c/Users/$win_username/AppData/Local/SumatraPDF/SumatraPDF.exe -new-window "$wpath" 
elif [ "$opener" = "pdfgear" ]; then
   /mnt/c/Program\ Files/PDFgear/PDFLauncher.exe  "$wpath"
elif [ "$opener" = "speedread" ]; then
  p=$(echo "page number to start from" | dmenu)
  pdftotext "$s" -f $p -layout - | speedread -w 350
else
  explorer.exe "$wpath"
fi
